{
  "version": 3,
  "sources": ["../../../../data/mods/gen8mixandmega/scripts.ts"],
  "sourcesContent": ["export const Scripts: ModdedBattleScriptsData = {\n\tgen: 8,\n\tinherit: 'gen8',\n\tinit() {\n\t\tfor (const i in this.data.Items) {\n\t\t\tconst item = this.data.Items[i];\n\t\t\tif (!item.megaStone || item.isNonstandard !== 'Past') continue;\n\t\t\tthis.modData('Items', i).onTakeItem = false;\n\t\t\tthis.modData('Items', i).isNonstandard = null;\n\t\t\tif (item.megaStone) {\n\t\t\t\tfor (const megaEvo of Object.values(item.megaStone)) {\n\t\t\t\t\tthis.modData('FormatsData', this.toID(megaEvo)).isNonstandard = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tactions: {\n\t\tcanMegaEvo(pokemon) {\n\t\t\tif (pokemon.species.isMega) return null;\n\n\t\t\tconst item = pokemon.getItem();\n\t\t\tif (!item.megaStone) return null;\n\t\t\treturn Object.values(item.megaStone)[0];\n\t\t},\n\t\trunMegaEvo(pokemon) {\n\t\t\tif (pokemon.species.isMega) return false;\n\n\t\t\tconst species: Species = (this as any).getMixedSpecies(pokemon.m.originalSpecies, pokemon.canMegaEvo, pokemon);\n\n\t\t\t/* Do we have a proper sprite for it? Code for when megas actually exist\n\t\t\tif (this.dex.species.get(pokemon.canMegaEvo!).baseSpecies === pokemon.m.originalSpecies) {\n\t\t\t\tpokemon.formeChange(species, pokemon.getItem(), true);\n\t\t\t} else { */\n\t\t\tconst oSpecies = this.dex.species.get(pokemon.m.originalSpecies);\n\t\t\tconst oMegaSpecies = this.dex.species.get((species as any).originalSpecies);\n\t\t\tpokemon.formeChange(species, pokemon.getItem(), true);\n\t\t\tthis.battle.add('-start', pokemon, oMegaSpecies.requiredItem, '[silent]');\n\t\t\tif (oSpecies.types.join('/') !== pokemon.species.types.join('/')) {\n\t\t\t\tthis.battle.add('-start', pokemon, 'typechange', pokemon.species.types.join('/'), '[silent]');\n\t\t\t}\n\t\t\t// }\n\n\t\t\tpokemon.canMegaEvo = false;\n\t\t\treturn true;\n\t\t},\n\t\tgetMixedSpecies(originalForme, formeChange, pokemon) {\n\t\t\tconst originalSpecies = this.dex.species.get(originalForme);\n\t\t\tconst formeChangeSpecies = this.dex.species.get(formeChange);\n\t\t\tconst deltas = (this as any).getFormeChangeDeltas(formeChangeSpecies, pokemon);\n\t\t\tconst species = (this as any).mutateOriginalSpecies(originalSpecies, deltas);\n\t\t\treturn species;\n\t\t},\n\t\tgetFormeChangeDeltas(formeChangeSpecies, pokemon) {\n\t\t\t// Should be fine as long as Necrozma-U doesn't get added or Game Freak makes me sad with some convoluted forme change\n\t\t\tlet baseSpecies = this.dex.species.get(formeChangeSpecies.isMega ?\n\t\t\t\tformeChangeSpecies.battleOnly as string : formeChangeSpecies.baseSpecies);\n\t\t\tif (formeChangeSpecies.name === 'Zygarde-Mega') {\n\t\t\t\tbaseSpecies = this.dex.species.get('Zygarde-Complete');\n\t\t\t}\n\t\t\tconst deltas: {\n\t\t\t\tability: string,\n\t\t\t\tbaseStats: SparseStatsTable,\n\t\t\t\tweighthg: number,\n\t\t\t\theightm: number,\n\t\t\t\toriginalSpecies: string,\n\t\t\t\trequiredItem: string | undefined,\n\t\t\t\ttype?: string,\n\t\t\t\tformeType?: string,\n\t\t\t\tisMega?: boolean,\n\t\t\t} = {\n\t\t\t\tability: formeChangeSpecies.abilities['0'],\n\t\t\t\tbaseStats: {},\n\t\t\t\tweighthg: formeChangeSpecies.weighthg - baseSpecies.weighthg,\n\t\t\t\theightm: ((formeChangeSpecies.heightm * 10) - (baseSpecies.heightm * 10)) / 10,\n\t\t\t\toriginalSpecies: formeChangeSpecies.name,\n\t\t\t\trequiredItem: formeChangeSpecies.requiredItem,\n\t\t\t};\n\t\t\tlet statId: StatID;\n\t\t\tfor (statId in formeChangeSpecies.baseStats) {\n\t\t\t\tdeltas.baseStats[statId] = formeChangeSpecies.baseStats[statId] - baseSpecies.baseStats[statId];\n\t\t\t}\n\t\t\tif (formeChangeSpecies.types.length > baseSpecies.types.length) {\n\t\t\t\tdeltas.type = formeChangeSpecies.types[1];\n\t\t\t} else if (formeChangeSpecies.types.length < baseSpecies.types.length) {\n\t\t\t\tdeltas.type = 'mono';\n\t\t\t} else if (formeChangeSpecies.types[1] !== baseSpecies.types[1]) {\n\t\t\t\tdeltas.type = formeChangeSpecies.types[1];\n\t\t\t}\n\t\t\tdeltas.isMega = true;\n\t\t\treturn deltas;\n\t\t},\n\t\tmutateOriginalSpecies(speciesOrForme, deltas) {\n\t\t\tif (!deltas) throw new TypeError(\"Must specify deltas!\");\n\t\t\tconst species = this.dex.deepClone(this.dex.species.get(speciesOrForme));\n\t\t\tspecies.abilities = { '0': deltas.ability };\n\t\t\tif (species.types[0] === deltas.type) {\n\t\t\t\tspecies.types = [deltas.type];\n\t\t\t} else if (deltas.type === 'mono') {\n\t\t\t\tspecies.types = [species.types[0]];\n\t\t\t} else if (deltas.type) {\n\t\t\t\tspecies.types = [species.types[0], deltas.type];\n\t\t\t}\n\t\t\tconst baseStats = species.baseStats;\n\t\t\tfor (const statName in baseStats) {\n\t\t\t\tbaseStats[statName] = this.battle.clampIntRange(baseStats[statName] + deltas.baseStats[statName], 1, 255);\n\t\t\t}\n\t\t\tspecies.weighthg = Math.max(1, species.weighthg + deltas.weighthg);\n\t\t\tspecies.heightm = Math.max(0.1, ((species.heightm * 10) + (deltas.heightm * 10)) / 10);\n\t\t\tspecies.originalSpecies = deltas.originalSpecies;\n\t\t\tspecies.requiredItem = deltas.requiredItem;\n\t\t\tif (deltas.isMega) species.isMega = true;\n\t\t\treturn species;\n\t\t},\n\t},\n};\n"],
  "mappings": "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",
  "names": []
}
